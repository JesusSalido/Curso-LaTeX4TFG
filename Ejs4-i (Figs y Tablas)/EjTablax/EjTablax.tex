%%%%%%%%%%%%%% 
% Fichero: EjTablax
% Autor: J. Salido (http://www.uclm.es/profesorado/jsalido)
% Fecha: febrero, 2017
% Descripción: Inclusión avanzada de tablas en LaTeX.
% Ejemplo del curso: “LaTeX esencial para preparación de TFG, Tesis
% y otros documentos académicos” (Esc. Sup. Informática-UCLM)
%%%%%%%%%%%%%%




%%%%%%%%%%%%%%
% Preámbulo del documento
%%%%%%%%%%%%%%
\documentclass[11pt,a4paper]{article} 
\usepackage[utf8]{inputenx} 
\usepackage[spanish, es-tabla]{babel} 
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry} % Márgenes 

% Tipografía
\usepackage{newpxtext}
\usepackage{newpxmath}

\usepackage{marvosym}
\usepackage{pifont} % Generación de símbolos especiales
\usepackage{textcomp}

\usepackage[T1]{fontenc} % Codificación de salida    
\usepackage{microtype} % Mejoras de microtipografía en la obtención de PDF (sólo para pdflatex)

\usepackage{url} % Para escritura de URL
\urlstyle{sf}
% Generación de hiperenlaces
\usepackage[pdftex,breaklinks,colorlinks,
	citecolor=blue, % Color de la citas
	urlcolor=blue, % Color de las URL
	bookmarksnumbered=true % Incluye números en bookmarks
    ]{hyperref}

% Listas
\usepackage{paralist} % Mayor control de listas
\usepackage{multicol} % Elementos en varias columnas

% Gráficos
\usepackage{graphicx}  % Inclusión de figuras y escalado de cajas
\usepackage{rotating}

% Declaración del path donde están los archivos de figuras. 
% También se puede incluir el path en el nombre del fichero.
\graphicspath{{../figs/}}  
\DeclareGraphicsExtensions{.pdf,.png,.jpg}
% Lista de extensiones de ficheros por orden de precedencia. De este modo no hace falta indicar la extensión del fichero y en caso de existir dos fichero con el mismos nombre y extensión diferente se emplea el que tiene una extensión con mayor prioridad.

% Tablas
\usepackage[table,hyperref,usenames,dvipsnames,svgnames]{xcolor}
\usepackage{tabularx,booktabs} % Tablas más complejas
\usepackage{multirow}% Tablas con celdas extendidas


\usepackage{caption} % Configuración de caption en objetos float
\captionsetup[table]{skip=5pt} 	% Separación del caption en las tablas aumentando el
% valor por defecto 


% Con estas instrucciones se ajustan los valores del índice
\setcounter{secnumdepth}{1} % Ajusta el valor del último nivel numerado
\setcounter{tocdepth}{2} %Ajusta el valor del último nivel que aparece en TOC



\author{Jesús Salido}
\title{Inclusión avanzada de tablas en \LaTeX{}}
\date{\today}


%%%%%%%%%%%%%%
% Comienzo del documento
%%%%%%%%%%%%%%
\begin{document}

\maketitle


\begin{abstract}
	Ilustración de algunas técnicas avanzadas de inclusión de tablas con paquetes especializados.
\end{abstract}

\tableofcontents


% Por defecto babel nombra a las tablas como cuadros. Esto se puede cambiar.
% Personalización de los títulos de los listados y del índice de tablas
\renewcommand{\listtablename}{Índice de tablas} % Nombre asignado a la lista
\renewcommand{\tablename}{Tabla} % Nombre asignado a tabla
\listoftables




\section{Expansión de celdas a filas y columnas}
El paquete \texttt{multirow} permite la expansión de celdas a varias columnas o filas empleando los comandos \texttt{multicolum} y \texttt{multirow} como se muestra en los siguientes ejemplos:

% Ejemplo
% ==========
\begin{table}[hbt]%
	\centering
	\caption{Ejemplo de expansión en columnas}
	\label{tab:expcolumnas}
	\begin{tabular}{|l|l|} % Expansión en columnas
	\hline
	\multicolumn{2}{|c|}{Alineación} \\
	\hline
	GK & Paul Robinson \\
	LB & Lucus Radebe \\
	DC & Michael Duberry \\
	DC & Dominic Matteo \\
	RB & Didier Domi \\
	MC & David Batty \\
	MC & Eirik Bakke \\
	MC & Jody Morris \\
	FW & Jamie McMaster \\
	ST & Alan Smith \\
	ST & Mark Viduka \\
	\hline
	\end{tabular}
\end{table}


% Ejemplo
% ==========

\begin{table}[hbt]%
	\centering
	\caption{Ejemplo de expansión en filas}
	\label{tab:expfilas}
	\begin{tabular}{|l|l|l|} % Expansión en filas
	\hline
	\multicolumn{3}{|c|}{Alineación} \\
	\hline
	Guardameta & GK & Paul Robinson \\ \hline
	\multirow{4}{*}{Defensas} & LB & Lucus Radebe \\
	 & DC & Michael Duberry \\
	 & DC & Dominic Matteo \\
	 & RB & Didier Domi \\ \hline
	\multirow{3}{*}{Centrocampistas} & MC & David Batty \\
	 & MC & Eirik Bakke \\
	 & MC & Jody Morris \\ \hline
	Delanteros & FW & Jamie McMaster \\ \hline
	\multirow{2}{*}{Puntas} & ST & Alan Smith \\
	 & ST & Mark Viduka \\
	\hline
	\end{tabular}
\end{table}




\newpage

% Ejemplo
% ==========
\begin{table}[hbt]%
	\centering
	\caption{Ejemplo de expansión simultánea en filas y columnas}
	\label{tab:expsimul}
	\begin{tabular}{cc|c|c|c|c|l} % Expansión simultánea en filas y columnas
	\cline{3-6}
	& & \multicolumn{4}{|c|}{Primos} \\ \cline{3-6}
	& & 2 & 3 & 5 & 7 \\ \cline{1-6}
	\multicolumn{1}{|c|}{\multirow{2}{*}{Potencias}} &
	\multicolumn{1}{|c|}{504} & 3 & 2 & 0 & 1 &     \\ \cline{2-6}
	\multicolumn{1}{|c|}{}                        &
	\multicolumn{1}{|c|}{540} & 2 & 3 & 1 & 0 &     \\ \cline{1-6}
	\multicolumn{1}{|c|}{\multirow{2}{*}{Potencias}} &
	\multicolumn{1}{|c|}{mcd} & 2 & 2 & 0 & 0 & min \\ \cline{2-6}
	\multicolumn{1}{|c|}{}                        &
	\multicolumn{1}{|c|}{mcm} & 3 & 3 & 1 & 1 & max \\ \cline{1-6}
	\end{tabular}
\end{table}




\subsection{Tablas con color}
El uso del color en los documentos académicos debe realizarse de modo muy comedido y sólo cuando el mismo sea fundamental para facilitar la comprensión de los contenidos expuestos. En las tablas se puede hace uso del color si se emplea el paquete \texttt{ctable} aunque para un uso más flexible se recomienda el paquete \texttt{xcolor} con la opción \texttt{table}.

% Ejemplo
% ==========
\begin{table}[hbt]
	\centering
	\caption[Tabla con color]{Ejemplo de tabla con colores}
%	\rowcolors{1}{}{lightgray}
	\rowcolors{1}{pink}{green}
	\begin{tabular}{lll}
		impar  & impar  & impar \\
		par    & par    & par   \\
		impar  & impar  & impar \\
		par    & par    & par   \\
	\end{tabular}
\end{table}



\subsection{Tablas apaisadas}
Puede ocurrir que debido al tamaño de la tabla, ésta quede mejor girada en la página para obtener una orientación apaisada. Este efecto se puede conseguir de un modo sencillo con el paquete \texttt{rotating} que no es preciso cargar explícitamente si se emplea el paquete \texttt{ctable}. Para conseguir el efecto mencionado se empleará el entorno \texttt{sidewaystable}, como se muestra en el caso de la tabla~\ref{tab:apaisada}.

% Ejemplo:
% ============
\begin{sidewaystable}
	\centering
	\caption[Ejemplo de tabla apaisada]{Tabla apaisada en una página}\label{tab:apaisada}
	\begin{tabular}{|llllllllp{1in}lp{1in}|}
		\hline
		Context   &Length   &Breadth/   &Depth   &Profile   &Pottery   &Flint   &Animal   &Stone   &Other    &C14 Dates \\
		&         &Diameter   &        &          &          &        & 
		Bones&&&\\
		\hline
		&&&&&&&&&&\\
		\multicolumn{10}{|l}{\bf Grooved Ware}&\\
		784       &---        &0.9m       &0.18m   &Sloping U &P1       &$\times$46  &  $\times$8      &&       $\times$2 bone&  2150$\pm$ 100 BC\\
		785       &---        &1.00m      &0.12    &Sloping U &P2--4    &$\times$23  &  $\times$21     & Hammerstone &---&---\\
		962       &---        &1.37m      &0.20m   &Sloping U &P5--6    &$\times$48  &  $\times$57*    & ---&     ---&1990 $\pm$ 80 BC (Layer 4) 1870 $\pm$90 BC (Layer 1)\\
		983       &0.83m      &0.73m      &0.25m   &Stepped U &---      &$\times$18  &  $\times$8      & ---& Fired clay&---\\
		&&&&&&&&&&\\
		\multicolumn{10}{|l}{\bf Beaker}&\\
		552       &---        &0.68m      &0.12m   &Saucer    &P7--14   &---           & ---       & ---       &---        &---\\
		790       &---        &0.60m      &0.25m   &U         &P15      &$\times$12    & ---       & Quartzite-lump&---    &---\\
		794       &2.89m      &0.75m      &0.25m   &Irreg.    &P16      &$\times$3     & ---       & ---       &---        &---\\
		\hline
	\end{tabular}
\end{sidewaystable}


\newpage
\subsection{Tablas escaladas}
Entre otros el paquete \texttt{graphicx} aporta comandos para realizar el escalado de objetos en un documento \LaTeX. Un caso especialmente interesante es la combinación de estos comandos de escalado para adaptar el tamaño de una tabla, aunque esto debe hacerse con sumo cuidado ya que el tamaño de las fuentes empleadas en la tabla quedará afectado en el mismo factor de escala aplicado y no se corresponderá con el tamaño del texto normal del documento. En la tabla~\ref{tab:escalada} se muestra el efecto de escalado para ajustar su tamaño al de la página.

% Ejemplo:
% ============
\begin{table}[hbt]
	\centering
	\caption{Tabla escalada}
	\label{tab:escalada}
	\resizebox{\textwidth}{!}{% En el escalado ajustamos sólo el ancho para mantener la proporción
		\begin{tabular}{|llllllllp{1in}lp{1in}|}
			\hline
			Context   &Length   &Breadth/   &Depth   &Profile   &Pottery   &Flint   &Animal   &Stone   &Other    &C14 Dates \\
			&         &Diameter   &        &          &          &        & 
			Bones&&&\\
			\hline
			&&&&&&&&&&\\
			\multicolumn{10}{|l}{\bf Grooved Ware}&\\
			784       &---        &0.9m       &0.18m   &Sloping U &P1       &$\times$46  &  $\times$8      &&       $\times$2 bone&  2150$\pm$ 100 BC\\
			785       &---        &1.00m      &0.12    &Sloping U &P2--4    &$\times$23  &  $\times$21     & Hammerstone &---&---\\
			962       &---        &1.37m      &0.20m   &Sloping U &P5--6    &$\times$48  &  $\times$57*    & ---&     ---&1990 $\pm$ 80 BC (Layer 4) 1870 $\pm$90 BC (Layer 1)\\
			983       &0.83m      &0.73m      &0.25m   &Stepped U &---      &$\times$18  &  $\times$8      & ---& Fired clay&---\\
			&&&&&&&&&&\\
			\multicolumn{10}{|l}{\bf Beaker}&\\
			552       &---        &0.68m      &0.12m   &Saucer    &P7--14   &---           & ---       & ---       &---        &---\\
			790       &---        &0.60m      &0.25m   &U         &P15      &$\times$12    & ---       & Quartzite-lump&---    &---\\
			794       &2.89m      &0.75m      &0.25m   &Irreg.    &P16      &$\times$3     & ---       & ---       &---        &---\\
			\hline
	\end{tabular}}
\end{table}



\newpage
\section{Tablas con mayor control del espaciado}
En el entorno tabular el control del espaciado entre columnas es demasiado <<burdo>>. Para facilitar esta labor existen paquetes como \texttt{tabularx}%\footnote{Este paquete ya se carga con el paquete \texttt{ctable}.} 
que ofrece un entorno del mismo nombre. Veamos algunos ejemplos.

% Ejemplo
% ==========
\begin{table}[htpb]
   \centering
   	\caption{Ejemplo de tabla con entorno \texttt{tabularx}}					\label{tab:tabularx1}
   \begin{tabularx}{\textwidth}% Se especifica el ancho completo de la tabla
   { |X|X|X|r| }
   \hline
   etiqueta 1 & etiqueta 2 & etiqueta 3 & etiqueta 4 \\
   \hline
   ítem 1     & ítem 2     & ítem 3     & ítem 4  \\
   \hline
	\end{tabularx}
\end{table}


% Ejemplo
% ==========
\begin{table}[htpb]
	\newcolumntype{R}{>{\raggedleft\arraybackslash}X}%
	\centering
    \caption{Otro ejemplo de tabla ampliada}
    \label{tab:tabularx2}
	\begin{tabularx}{\textwidth}{ |l|R|l|R| }
  	\hline
   etiqueta 1 & etiqueta 2 & etiqueta 3 & etiqueta 4 \\
   \hline
   ítem 1     & ítem 2     & ítem 3     & ítem 4  \\
  	\hline
   \end{tabularx}
\end{table}




\newpage
\section{Tablas profesionales}
Para conseguir unas tablas de acabado más profesional puede emplearse alguno de los paquetes dedicados como \texttt{booktabs} (ver tablas~\ref{tab:normal} y \ref{tab:booktabs}).
 
% Ejemplo
% ==========
\begin{table}[hbt]
   \centering
   	  \caption{Tabla convencional \LaTeX}
   	  \label{tab:normal}
      \begin{tabular}{llr}
      \hline
      \multicolumn{2}{c}{Item} \\ 
      \cline{1-2}
      Animal & Description & Price (\$) \\ 
      \hline
      Gnat  & per gram & 13.65 \\
            & each     &  0.01 \\
      Gnu   & stuffed  & 92.50 \\
      Emu   & stuffed  & 33.33 \\
      Armadillo & frozen & 8.99 \\ 
      \hline
      \end{tabular}
\end{table}


% Ejemplo
% ==========
\begin{table}[hbt]
   \centering
   	  \caption{Tabla con paquete \texttt{booktabs}}
   	  \label{tab:booktabs}      
   	  \begin{tabular}{llr}
      \toprule
      \multicolumn{2}{c}{Item} \\
      \cmidrule(r){1-2}
      Animal & Description & Price (\$) \\
      \midrule
      Gnat  & per gram & 13.65 \\
            & each     &  0.01 \\
      Gnu   & stuffed  & 92.50 \\
      Emu   & stuffed  & 33.33 \\
      Armadillo & frozen & 8.99 \\
      \bottomrule
      \end{tabular}
\end{table}



\end{document}
